<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ihre Aktien-Chance in Deutschland & Ã–sterreich</title>
<style>
  body {
    font-family: Arial, Helvetica, sans-serif;
    background-color: #f4f7fb;
    background-image: url('https://images.unsplash.com/photo-1569025690938-a00729c9e4eb?auto=format&fit=crop&w=1920&q=80');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    margin: 0;
    padding: 0;
  }
  .container {
    max-width: 800px;
    margin: 50px auto;
    background: rgba(255, 255, 255, 0.9);
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 0 15px rgba(0,0,0,0.1);
  }
  h1 { color: #003366; }
  ul { line-height: 1.8; }
  .cta {
    background: #25d366;
    padding: 15px;
    text-align: center;
    color: white;
    font-size: 20px;
    margin-top: 20px;
    border-radius: 5px;
    cursor: pointer;
    user-select: none;
  }
  .cta:hover { background: #1ebe57; }
  .blocked {
    text-align: center;
    padding: 50px;
    font-size: 18px;
    color: red;
    background: rgba(255,255,255,0.85);
    border-radius: 10px;
    max-width: 600px;
    margin: 80px auto;
  }
</style>
</head>
<body>
<div id="content"></div>

<script>
const googleScriptURL = "https://script.google.com/macros/s/AKfycbz4qCLwaA_9X9Kk9tIGwY2G3_MCy7ISQXZDpwiNL7-kzecAb1YnP_v_GBq3JQd14arv5g/exec";

const WHATSAPP_PHONE = "https://api.whatsapp.com/send/?phone=491639447584&text=Ich+m%C3%B6chte+die+10+kostenlosen+Aktientipps+erhalten"; 
const whatsappUrl = https:https://api.whatsapp.com/send/?phone=491639447584&text=Ich+m%C3%B6chte+die+10+kostenlosen+Aktientipps+erhalten;

let visitLog = {
  ip: "",
  country: "",
  device: navigator.userAgent,
  language: navigator.language,
  status: ""
};

function sendToGoogleSheet(data) {
  fetch(googleScriptURL, {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  }).catch(err => console.error("å†™å…¥å¤±è´¥", err));
}

function showLandingPage() {
  document.getElementById("content").innerHTML = `
    <div class="container">
      <h1>ğŸš€ Exklusive Aktienchance fÃ¼r Anleger in Deutschland & Ã–sterreich</h1>
      <p>Erhalten Sie Insider-Einblicke in die schnell wachsenden Unternehmen und profitieren Sie von strategischen Investitionen.</p>
      <ul>
        <li>ğŸ“ˆ Marktanalysen in Echtzeit</li>
        <li>ğŸ’¡ Experten-Strategien</li>
        <li>ğŸ”’ 100% Datenschutz</li>
      </ul>
      <div id="whatsappBtn" class="cta">Jetzt kostenlos via WhatsApp anfragen</div>
    </div>`;

  document.getElementById("whatsappBtn").addEventListener("click", () => {
    // è®°å½•ç‚¹å‡»æ—¥å¿—
    let clickLog = {
      ip: visitLog.ip,
      country: visitLog.country,
      device: visitLog.device,
      language: visitLog.language,
      status: "WhatsApp_Click"
    };
    sendToGoogleSheet(clickLog);
    // è·³è½¬ WhatsApp
    window.open(whatsappUrl, "_blank");
  });
}

function showBlockedPage() {
  document.getElementById("content").innerHTML = `
    <div class="blocked">
      Zugriff verweigert â€“ Diese Seite ist nur fÃ¼r Deutschland & Ã–sterreich.
    </div>`;
}

fetch("https://ipapi.co/json/")
  .then(res => res.json())
  .then(data => {
    visitLog.ip = data.ip || "";
    visitLog.country = data.country || "";

    // å†™å…¥è®¿é—®è®°å½•
    visitLog.status = "Visit_Start";
    sendToGoogleSheet(visitLog);

    if (visitLog.country === "DE" || visitLog.country === "AT") {
      visitLog.status = "Allowed";
      sendToGoogleSheet(visitLog);
      showLandingPage();
    } else {
      visitLog.status = "Blocked";
      sendToGoogleSheet(visitLog);
      showBlockedPage();
    }
  })
  .catch(err => {
    console.error("IP è·å–å¤±è´¥", err);
    visitLog.status = "ErrorIP";
    sendToGoogleSheet(visitLog);
    showBlockedPage();
  });
</script>
</body>
</html>
